DROP TABLE IF EXISTS Admin;
DROP TABLE IF EXISTS HelpSeeker;
DROP TABLE IF EXISTS VolunteerSkills;
DROP TABLE IF EXISTS VolunteerAvailability;
DROP TABLE IF EXISTS VolunteerOrganization;
DROP TABLE IF EXISTS Volunteer;
DROP TABLE IF EXISTS SystemUser;
DROP TABLE IF EXISTS PersonInNeed;
DROP TABLE IF EXISTS Events;
DROP TABLE IF EXISTS EventParticipants;

CREATE TABLE SystemUser (
    username TEXT PRIMARY KEY,
    password TEXT NOT NULL,
    email TEXT,
    phone TEXT,
    address TEXT
);

CREATE TABLE Volunteer (
    username TEXT PRIMARY KEY,
    fullName TEXT,
    averageRating REAL DEFAULT 0,
    ratingCount INT DEFAULT 0,
    FOREIGN KEY (username) REFERENCES SystemUser(username)
);

CREATE TABLE VolunteerSkills (
    skillId INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT,
    skill TEXT NOT NULL,
    FOREIGN KEY (username) REFERENCES Volunteer(username)
);

CREATE TABLE VolunteerAvailability (
    availabilityId INTEGER PRIMARY KEY AUTOINCREMENT,
    username TEXT,
    dayOfWeek TEXT NOT NULL,
    hours INTEGER NOT NULL,
    FOREIGN KEY (username) REFERENCES Volunteer(username)
);

CREATE TABLE VolunteerOrganization (
    username TEXT PRIMARY KEY,
    organizationName TEXT,
    licenseNumber TEXT,
    FOREIGN KEY (username) REFERENCES SystemUser(username)
);

CREATE TABLE PersonInNeed (
    username TEXT PRIMARY KEY,
    fullName TEXT,
    FOREIGN KEY (username) REFERENCES SystemUser(username)
);

CREATE TABLE Admin (
    username TEXT PRIMARY KEY,
    password TEXT NOT NULL,
    email TEXT,
    phone TEXT,
    fullName TEXT
);

CREATE TABLE Events (
    eventId INTEGER PRIMARY KEY,
    title TEXT,
    maxParticipantNumber INTEGER,
    supportType VARCHAR(50),
    startDay INTEGER,
    startMonth INTEGER,
    startYear INTEGER,
    endDay INTEGER,
    endMonth INTEGER,
    endYear INTEGER,
    emergencyLevel VARCHAR(20),
    description TEXT,
    organizer TEXT,
    needer TEXT,
    status VARCHAR(20) DEFAULT 'pending',
    FOREIGN KEY (organizer) REFERENCES VolunteerOrganization(username),
    FOREIGN KEY (needer) REFERENCES PersonInNeed(username)
);

CREATE TABLE EventParticipants (
    eventId INTEGER,
    username TEXT,
    PRIMARY KEY (eventId, username),
    FOREIGN KEY (eventId) REFERENCES Events(eventId),
    FOREIGN KEY (username) REFERENCES Volunteer(username)
);

INSERT INTO SystemUser (username, password, email, phone, address)
VALUES ('tnv', '123', 'volunteer@example.com', '0123456789', 'Hanoi, Vietnam');

INSERT INTO Volunteer (username, fullName)
VALUES ('tnv', 'Nguyen Van Tinh Nguyen');

INSERT INTO SystemUser (username, password, email, phone, address)
VALUES ('tochuc', '123', 'organization@example.com', '0987654321', 'Ho Chi Minh City, Vietnam');

INSERT INTO VolunteerOrganization (username, organizationName, licenseNumber)
VALUES ('tochuc', 'Tổ chức áo đen', 'LIC-123456');

INSERT INTO SystemUser (username, password, email, phone, address)
VALUES ('nguoicangiup', '123', 'needperson@example.com', '0369852147', 'Da Nang, Vietnam');

INSERT INTO PersonInNeed (username, fullName)
VALUES ('nguoicangiup', 'Tran Thi Can Giup');
